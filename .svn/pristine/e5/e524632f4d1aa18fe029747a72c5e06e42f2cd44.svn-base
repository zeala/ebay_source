package com.ebayproject.components.imageScroll {		import flash.events.Event;	import flash.events.TimerEvent;	import flash.utils.Timer;		import mx.collections.ArrayCollection;	import mx.core.UIComponent;
	public class Navigator extends UIComponent{		/**		 * Array of NavItem objects to display in the scroll list 		 */				private var _navArray	:Array;		/**		 * Currently selected NavItem 		 */				private var clip		:NavItemMXML;		/**		 * Damping applied to TweenLight movements.		 * Affects the speed at which items scroll		 * when a NavItem is clicked		 */		private var _damping	:Number		= 10;		/**		 * The center point on the xAxis. Used as a target		 * for lining the selected NavItem in the center		 * 		 * TODO: Add centerY for vertical layout, add ability		 * to update based on current application size 		 */		private var _centerX	:Number		= 200;		/**		 * The sum of all the NavItem widths 		 */		private var totalWidth	:Number		= 0;		/**		 * The current width of the container.		 * 		 * TODO: containerHeight for vertical layouts.		 * Update on app resize. 		 */		private var _containerWidth:Number = 0;		/**		 * The width of an individual item. 		 * 		 * TODO: This should be changed to accept variables		 * as well as adding a height for vertical layouts. 		 */				private var _itemWidth:Number = 0;		/**		 * A timer for slideshow playback 		 */		private var timer:Timer;		/**		 * The current slide in a slide show 		 */		private var currentSlide:int = 0;		private var _slideDelaySeconds:Number = 3;							/**		 * Constructor for Navigator		 *  		 * @param images XML list of images to load		 * @param damping Controls the transition speed as list scrolls		 * @param thumbSize the size of the thumbnail object		 * @param centerX The mid-point.		 * @param containerWidth The width of the container holding the navigator.		 * @param slideShow is this a slideshow?		 * @param slideDelatSeconds how many seconds to hold each fram in a slideshow.		 * 		 */					public function Navigator(			items : ArrayCollection, damping : Number , centerX : Number,			containerWidth : Number, slideshow : Boolean = false,			slideDelaySeconds : Number = 3 )		{			super();			_damping	=  damping;			_centerX	= centerX;			_navArray	= [];			_containerWidth = containerWidth;			_slideDelaySeconds = slideDelaySeconds			var count:int = 0;						for each ( var imgSource : String in items )			{				var navItem : NavItemMXML = new NavItemMXML();				navItem.index = count;				navItem.searchItem = items[count];				navItem.addEventListener( NavItemMXML.EVENT_CLICKED, centerNav );				addChild( navItem );				_navArray.push( navItem );				totalWidth += navItem.width;				count ++;			}									trace("\nTOTAL WIDTH : " + totalWidth )			if( slideshow )			{	 			startSlideshow( )					}			//select the first image			_navArray[0].dispatchEvent( new Event( NavItemMXML.EVENT_CLICKED ) );			swap();		}				/**		 * Start the slideshow 		 * 		 */				public function startSlideshow( ):void		{ 			timer = new Timer( _slideDelaySeconds * 1000 ) 			timer.addEventListener( TimerEvent.TIMER, onTimer ); 			 			timer.start();						}				/**		 * Stop the slideshow		 * 		 */				public function stopSlideshow( ):void		{			timer.removeEventListener( TimerEvent.TIMER, onTimer );			timer.stop();		}				/**		 * "Click" the next image in the sequence. Currently these clicks are odd		 * because it is neccesary to figure out exactly which item needs to be clicked		 * based on its position in the container relative to the center, currently selected item.		 *  		 * @param te		 * @private		 */				private function onTimer( te:TimerEvent ):void		{			for( var i:int=0;i<this.navArray.length;i++)			{				var navItem:NavItemMXML = navArray[i];				trace( navItem.index, clip.index );				if( clip.index == navArray.length - 1 )				{					if( navItem.index == 0 )					{						_navArray[i].dispatchEvent( new Event( NavItemMXML.EVENT_CLICKED ) );						return					}				}				if( navItem.index == clip. index +1 )				{					_navArray[i].dispatchEvent( new Event( NavItemMXML.EVENT_CLICKED ) );					return;				}			}		}				/**		 * Shifts the images to keep the continuous scroll continuous		 * @private		 */				private function swap():void {			aligned();						var left:NavItemMXML = _navArray[0];			var right:NavItemMXML = _navArray[_navArray.length-1];						for (var i:int = 0; i<_navArray.length; i++) {				if (left.x<0-left.width) {					// moves clips from first to last					_navArray.push(_navArray.shift());					left.x = right.x+right.width;				}				                       				if (right.x>totalWidth-right.width) {					// moves clips from last to first					_navArray.unshift(_navArray.pop());					right.x = left.x-right.width;				}			}		}				/**		 * Moves the selected NavItem to the center of the navigation container. 		 * @param e		 * @private		 */				private function centerNav(e:Event):void 		{			//if( timer ) stopSlideshow();						removeEventListener(Event.ENTER_FRAME, setPositions);							clip = e.target as NavItemMXML;			trace(clip.index)			for (var i:int = 0; i<_navArray.length; i++) {				if(navArray[i]!=clip){					navArray[i].enable();				} else navArray[i].disable();			}			addEventListener(Event.ENTER_FRAME, setPositions);		}				/**		 * Set the positions of the NavItems 		 * @param e		 * @private		 */				private function setPositions(e:Event = null):void {			var thisX	:Number	= clip.x+clip.width;			var deltaX	:Number	= thisX-(_centerX + clip.width / 2 );			_navArray[0].x -= deltaX/_damping;			swap();						if (Math.abs(deltaX)<1) {				removeEventListener(Event.ENTER_FRAME, setPositions);				}		}		/**		 * Make sure all of the NavItems stay aligned while they are swapped 		 * @private		 */				private function aligned():void {			for (var i:int = 1; i<_navArray.length; i++) {				_navArray[i].x = _navArray[i-1].x+_navArray[i-1].width;			}		}				/**		 * An array of NavItems		 * @return 		 * 		 */				public function get navArray():Array { return _navArray; }			}	}